import{_ as p,M as o,p as c,q as i,R as a,N as n,V as e,t,a1 as l}from"./framework-7e1a102e.js";const r={},d={class:"table-of-contents"},u=l(`<p>[toc]</p><h2 id="在线预览总结" tabindex="-1"><a class="header-anchor" href="#在线预览总结" aria-hidden="true">#</a> 在线预览总结</h2><p>免费的只有谷歌，微软，但仅限于查看；其它的第三方基本都是收费方案 但是功能更完备</p><h3 id="onlyoffice-社区版" tabindex="-1"><a class="header-anchor" href="#onlyoffice-社区版" aria-hidden="true">#</a> onlyoffice 社区版</h3><p>免费，需要部署配置</p><ul><li><code>https://github.com/ONLYOFFICE/DocumentServer</code></li></ul><h4 id="页面接入" tabindex="-1"><a class="header-anchor" href="#页面接入" aria-hidden="true">#</a> 页面接入</h4><p>配置地址 https://api.onlyoffice.com/</p><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>placeholder<span class="token punctuation">&quot;</span></span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token value css language-css"><span class="token property">height</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span></span><span class="token punctuation">&quot;</span></span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text/javascript<span class="token punctuation">&quot;</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>部署地址/web-apps/apps/api/documents/api.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
    <span class="token keyword">var</span> config <span class="token operator">=</span><span class="token punctuation">{</span>
        <span class="token string-property property">&quot;document&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token string-property property">&quot;fileType&quot;</span><span class="token operator">:</span> <span class="token string">&quot;docx&quot;</span><span class="token punctuation">,</span>
            <span class="token string-property property">&quot;key&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Khirz6zTPdfd7122&quot;</span><span class="token punctuation">,</span><span class="token comment">// 每次访问必须不一样</span>
            <span class="token string-property property">&quot;title&quot;</span><span class="token operator">:</span> <span class="token string">&quot;name.docx&quot;</span><span class="token punctuation">,</span>
            <span class="token string-property property">&quot;url&quot;</span><span class="token operator">:</span> <span class="token string">&quot;文件地址&quot;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">var</span> docEditor <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DocsAPI<span class="token punctuation">.</span>DocEditor</span><span class="token punctuation">(</span><span class="token string">&quot;placeholder&quot;</span><span class="token punctuation">,</span> config<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="kkfileview" tabindex="-1"><a class="header-anchor" href="#kkfileview" aria-hidden="true">#</a> kkfileview</h3><p>免费 需要部署 <code>https://kkfileview.keking.cn/zh-cn/docs/home.html</code></p><h3 id="pdf" tabindex="-1"><a class="header-anchor" href="#pdf" aria-hidden="true">#</a> pdf</h3><p>在 PC 可以直接在浏览器打开预览，移动端也可以下载预览，如果这些方式都不采用，使用 pdf.js 实现在线预览</p><h4 id="pdf-js-使用" tabindex="-1"><a class="header-anchor" href="#pdf-js-使用" aria-hidden="true">#</a> pdf.js 使用</h4><p>这里提供一个最简洁的方式：</p><p>登录官网 下载支持最新浏览器的版本或兼容老版本浏览器</p><p>直接部署下载下来的项目；路由链接到 /web/viewer.html</p><p>注意注释掉跨域代码</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token comment">// if (origin !== viewerOrigin &amp;&amp; protocol !== &quot;blob:&quot;) {</span>
<span class="token comment">//   throw new Error(&quot;file origin does not match viewer&#39;s&quot;);</span>
<span class="token comment">// }</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>传入要预览的pdf文件地址；注意：该文件地址应该是可以在浏览器地址栏直接打开，不需要鉴权等操作的</p><p>通过 url 传参 /web/viewer.html?file=&quot;xxxx/xx/xx.pdf&quot;</p><h2 id="google-和-office-的方案" tabindex="-1"><a class="header-anchor" href="#google-和-office-的方案" aria-hidden="true">#</a> Google 和 office 的方案</h2><p>目前移动端基本是可以实现文件的下载预览(包括成android和ios)，但在有些环境下无法下载或是 ios 端有些问题，所以需要在线预览</p><p>引用参考： https://gist.github.com/tzmartin/1cf85dc3d975f94cfddc04bc0dd399be</p><h2 id="office-web-apps-viewer" tabindex="-1"><a class="header-anchor" href="#office-web-apps-viewer" aria-hidden="true">#</a> Office Web Apps Viewer</h2><p>(&#39;.ppt&#39; &#39;.pptx&#39; &#39;.doc&#39;, &#39;.docx&#39;, &#39;.xls&#39;, &#39;.xlsx&#39;) 注意：pdf不能解析</p><ul><li><code>http://view.officeapps.live.com/op/view.aspx?src=xxxx</code></li><li><code>https://view.officeapps.live.com/op/embed.aspx?src=xxx</code></li></ul><p>以上两个链接都可以</p><h3 id="onedrive-embed-links" tabindex="-1"><a class="header-anchor" href="#onedrive-embed-links" aria-hidden="true">#</a> OneDrive Embed Links</h3><p><strong>Powerpoint</strong></p><ul><li><code>https://onedrive.live.com/embed?cid=CA582F2BC3AD1590&amp;resid=CA582F2BC3AD1590%2133463&amp;authkey=AFh1O3tkDLAQzzw&amp;em=2</code></li></ul><p><strong>Excel</strong><code>https://onedrive.live.com/embed?cid=CA582F2BC3AD1590&amp;resid=CA582F2BC3AD1590%2136277&amp;authkey=AHJ96YRJIbbJcec&amp;em=2</code></p><h2 id="google-docs-viewer" tabindex="-1"><a class="header-anchor" href="#google-docs-viewer" aria-hidden="true">#</a> Google Docs Viewer</h2><p>这个网络会有问题，是国外的服务器</p><p><code>https://docs.google.com/viewer?url=http://infolab.stanford.edu/pub/papers/google.pdf&amp;embedded=true</code></p><p>注意带上 &amp;embedded=true</p><p>文件要小于 25MB</p><p>其它信息 参考 https://gist.github.com/tzmartin/1cf85dc3d975f94cfddc04bc0dd399be</p>`,38);function k(h,f){const s=o("router-link");return c(),i("div",null,[a("nav",d,[a("ul",null,[a("li",null,[n(s,{to:"#在线预览总结"},{default:e(()=>[t("在线预览总结")]),_:1}),a("ul",null,[a("li",null,[n(s,{to:"#onlyoffice-社区版"},{default:e(()=>[t("onlyoffice 社区版")]),_:1})]),a("li",null,[n(s,{to:"#kkfileview"},{default:e(()=>[t("kkfileview")]),_:1})]),a("li",null,[n(s,{to:"#pdf"},{default:e(()=>[t("pdf")]),_:1})])])]),a("li",null,[n(s,{to:"#google-和-office-的方案"},{default:e(()=>[t("Google 和 office 的方案")]),_:1})]),a("li",null,[n(s,{to:"#office-web-apps-viewer"},{default:e(()=>[t("Office Web Apps Viewer")]),_:1}),a("ul",null,[a("li",null,[n(s,{to:"#onedrive-embed-links"},{default:e(()=>[t("OneDrive Embed Links")]),_:1})])])]),a("li",null,[n(s,{to:"#google-docs-viewer"},{default:e(()=>[t("Google Docs Viewer")]),_:1})])])]),u])}const m=p(r,[["render",k],["__file","onlineView.html.vue"]]);export{m as default};
